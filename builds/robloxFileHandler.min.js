import*as fs from"fs";import*as xml2js from"xml2js";class Instance{constructor(){this.Archivable=!0,this.ClassName=this.constructor.name,this.Name=this.constructor.name,this.Parent=null,this.RobloxLocked=!1,this.Children=[],this._isDistroyed=!1,this.referentId=""}set _isDistroyed(e){!0===e&&this.Distroy()}ClearAllChildren(){null==Children[0]||this._isDistroyed||this.Children.forEach(e=>{Distroy()})}Clone(){if(!this._isDistroyed||this.Archivable){let t=Object.assign({},this);return t.Children=[],this.Children.forEach(e=>{this.Archivable&&t.Children.push(e)}),t}}Distroy(){if(!this._isDistroyed){if(this.Parent){const e=this.Parent.Children.indexOf(this);e=e.splice(x,1),this.Parent=null}this.Archivable=!1,this._isDistroyed=!0,this.ClearAllChildren(),Children=[]}}GetChildren=()=>{this._isDistroyed||this.Children||this.Children};GetDescendants(){if(!this._isDistroyed){let e=this.GetChildren(),t=[...e];return e.forEach(e=>{t.concat(e.GetDescendants())}),t}}IsA=e=>!_isDistroyed&&this instanceof RoModules.Classes[e];IsAncestorOf(e){if(!_isDistroyed){e=e.Parent;return!!e&&(e===this||this.IsAncestorOf(e))}}IsDescendantOf=e=>!_isDistroyed&&e.IsAncestorOf(this)}class PVInstance extends Instance{constructor(){super()}}class BasePart extends PVInstance{constructor(){super(),this.Anchored=!1,this.AssemblyAngularVelocity,this.AssemblyCenterOfMass,this.AssemblyLinearVelocity,this.AssemblyMass,this.AssemblyRootPart,this.BackSurface,this.BottomSurface,this.BrickColor,this.CFrame,this.CanCollide,this.CanQuery,this.CanTouch,this.CastShadow,this.CenterOfMass,this.CollisionGroupId,this.Color,this.CustomPhysicalProperties,this.FrontSurface,this.LeftSurface,this.LocalTransparencyModifier,this.Locked,this.Mass,this.Massless,this.Material,this.Orientation,this.PivotOffset,this.Position,this.ReceiveAge,this.Reflectance,this.ResizeIncrement,this.ResizeableFaces,this.RightSurface,this.RootPriority,this.Rotation,this.Size,this.TopSurface,this.Transparency}}class Camera extends Instance{constructor(){super(),this.CFrame,this.CameraSubject,this.CameraType,this.DiagonalFieldOfView,this.FieldOfView,this.FieldOfViewMode,this.Focus,this.HeadLocked,this.HeadScale,this.MaxAxisFieldOfView,this.NearPlaneZ,this.ViewportSize}}class Folder extends Instance{constructor(){super()}}class FormFactorPart extends BasePart{constructor(){super()}}class GuiService extends Instance{constructor(){super(),this.AutoSelectGuiEnabled,this.CoreGuiNavigationEnabled,this.GuiNavigationEnabled,this.MenuIsOpen,this.SelectedObject}}class Model extends PVInstance{constructor(){super(),this.ClassName="Model",this.WorldPivot,this.PrimaryPart,this.LevelOfDetail}}class Part extends FormFactorPart{constructor(){super(),this.ClassName="Part",this.Shape}}class Players extends Instance{constructor(){super(),this.BubbleChat,this.CharacterAutoLoads,this.ClassicChat,this.LocalPlayer,this.MaxPlayers,this.MaxPlayersNumberernal,this.PreferredPlayers,this.PreferredPlayersNumberernal,this.RespawnTime}}class Selection extends Instance{constructor(){super(),this.ActiveInstance,this.SelectionThickness}}class Terrain extends BasePart{constructor(){super(),this.Decoration,this.MaterialColors,this.MaxExtents,this.WaterColor,this.WaterReflectance,this.WaterTransparency,this.WaterWaveSize,this.WaterWaveSpeed}}class Workspace extends Model{constructor(){super(),this.ClassName="Workspace",this.AllowThirdPartySales=!1,this.AnimationWeightedBlendFix,this.ClientAnimatorThrottling,this.CurrentCamera,this.DistributedGameTime,this.FallenPartsDestroyHeight,this.Gravity,this.HumanoidOnlySetCollisionsOnStateChange,this.InterpolationThrottling,this.MeshPartHeadsAndAccessories,this.PhysicsSimulationRate,this.PhysicsSteppingMethod,this.SignalBehavior,this.StreamingEnabled,this.StreamingMinRadius,this.StreamingPauseMode,this.StreamingTargetRadius,this.Terrain,this.TouchesUseCollisionGroups}}function lerp(e,t,s){return(1-s)*e+s*t}function toBytesInt32(e){var t=new ArrayBuffer(4);const s=new DataView(t);return s.setUint32(0,e,!1),t}class BaseVector{constructor(...e){this.values=e}lerp(t,e,...s){let r=[];e instanceof BaseVector?s=e.values:s.push(e);for(let e=0;e<Math.max(this.values.length,s.length);e++){var i=this.values[e]||0,a=s[e]||0;r[e]=lerp(i,a,t)}return new BaseVector(...r)}}class Vector3 extends BaseVector{constructor(e=0,t=0,s=0){super(e,t,s),this.X=this.values[0],this.Y=this.values[1],this.Z=this.values[2]}}class CFrame{constructor(e=0,t=0,s=0,r=0,i=0,a=0,o=0,n=0,c=0,h=0,l=0,u=0){this.x=e,this.y=t,this.z=s,this.R00=r,this.R01=i,this.R02=a,this.R10=o,this.R11=n,this.R12=c,this.R20=h,this.R21=l,this.R22=u,e instanceof Vector3&&this._setXYZFromVector3(e)}_setXYZFromVector3(e,t){this.x=e.x,this.y=e.y,this.z=e.z}get Position(){return new Vector3(this.x,this.y,this.z)}set Position(e){e instanceof Vector3?this._setXYZFromVector3(e):e instanceof Array&&(this.x=e[0],this.x=e[1],this.x=e[2])}}class Color3 extends BaseVector{constructor(e,t,s){super(e,t,s),this.R=e,this.G=t,this.B=s}}class Color3uint8 extends BaseVector{constructor(e,t,s,r=255){if(super(r,e,t,s),"number"==typeof e)if("number"==typeof t)this.values=[r,e,t,s];else{s=toBytesInt32(e);let t=new DataView(s);for(let e=0;e<t.byteLength;e++)this.values[e]=t.getUint8(e)}else e instanceof Color3&&(this.values=[r,...e.values]);this.A=this.values[0],this.alpha=this.values[0],this.R=this.values[1],this.G=this.values[2],this.B=this.values[3],this.Color3=new Color3(this.R,this.G,this.B)}getRGBComponents=()=>[this.R,this.G,this.B]}const InputType={NoInput:0,Constant:12,Sin:13};Object.freeze(InputType);const Material={Plastic:256,Wood:512,Slate:800,Concrete:816,CorrodedMetal:1040,DiamondPlate:1056,Foil:1072,Grass:1280,Ice:1536,Marble:784,Granite:832,Brick:848,Pebble:864,Sand:1296,Fabric:1312,SmoothPlastic:272,Metal:1088,WoodPlanks:528,Cobblestone:880,Air:1792,Water:2048,Rock:896,Glacier:1552,Snow:1328,Sandstone:912,Mud:1344,Basalt:788,Ground:1360,CrackedLava:804,Neon:288,Glass:1568,Asphalt:1376,LeafyGrass:1284,Salt:1392,Limestone:820,Pavement:836,ForceField:1584};Object.freeze(Material);const PartType={Ball:0,Block:1,Cylinder:2};Object.freeze(PartType);const SurfaceType={Smooth:0,Glue:1,Weld:2,Studs:3,Inlet:4,Universal:5,Hinge:6,Motor:7,SteppingMotor:8,SmoothNoOutlines:10};Object.freeze(SurfaceType);class NotFoundError extends Error{constructor(e,t){super(e),this.name=this.constructor.name,this.originalError=t,this.errorParsed=!0,Error.captureStackTrace(this,this.constructor)}}function _errorToCustomError(e){if(null!=e)return e.errorParsed?e:"ENOENT"===e.code?new NotFoundError(`Cound not find file '${e.path}'`,e):void 0}const RoClasses={BasePart:BasePart,Camera:Camera,Folder:Folder,FormFactorPart:FormFactorPart,GuiService:GuiService,Instance:Instance,Model:Model,Part:Part,Players:Players,PVInstance:PVInstance,Selection:Selection,Terrain:Terrain,Workspace:Workspace},RoTypes={BaseVector:BaseVector,CFrame:CFrame,Color3:Color3,Color3uint8:Color3uint8,Vector3:Vector3},RoEnums={InputType:InputType,Material:Material,PartType:PartType,SurfaceType:SurfaceType},RoModules$1={...RoClasses,...RoTypes,...RoEnums},xmlParser=new xml2js.Parser;class Parser{constructor(){this.REFIDTOINSTANCE={}}toValidInstance(e){if(e)return"string"==typeof e?this.REFIDTOINSTANCE[e]:e instanceof RoClasses.Instance?e:isItem(e)?this.itemToInstance(e):void 0}itemToInstance(t,e,s){var r={REFIDTOINSTANCE:this.REFIDTOINSTANCE,returnErrors:!1};s={...r,...s};try{if(t.isParsed)return t}catch(e){if(s.returnErrors)throw _errorToCustomError(e);return t}const i=t.Item;var a=t.Properties[0],r=t.$.referent,t=t.$.class;e=this.itemToInstance(e);let o=[],n=null;try{n=new RoClasses[t]}catch(e){return}n.isParsed=!0,n.Parent=e,null!=r&&(n.referentId=r,s.REFIDTOINSTANCE[r]=n),i&&i.forEach((e,t)=>o[t]=this.itemToInstance(e,n)),n.Children=o;for(const c in a){const h=a[c];h.forEach(e=>{e:try{n[e.$.name]=_convertPropertyToType(e,c,s)}catch(e){break e}})}return n}fileToObject(e){let t,s;try{t=fs.readFileSync(e)}catch(e){throw _errorToCustomError(e)}return xmlParser.parseString(t,(e,t)=>{if(e)throw e;s=t}),s}xmlToObject(e){let s;return xmlParser.parseString(e,(e,t)=>{if(e)throw _errorToCustomError(e);s=t}),s}objToInstance(e){if(Array.isArray(e)){let t=[];return e.forEach(e=>t.push(objectToInsts(e))),t}return e.Item?itemToInstance(e.Item):isItem(e)?itemToInstance(e):void 0}parseFile(e){e=this.fileToObject(e);if(e.roblox){e=e.roblox;let t=[];const s=e.Item;return s.forEach(e=>t.push(this.itemToInstance(e))),t}}}function isXMLTag(e){if("object"==typeof e){for(const t in e)return!0;return!1}{let s;if(xmlParser.parseString(e,(e,t)=>{if(e)throw e;s=isXMLTag(t)}),s)return s}}const isItem=e=>isXMLTag(e)&&e.$.referent||!e.isParsed;function findFirstItemByClassName(t,s,e){for(var r in s=s.toLocaleLowerCase(),t){let e=t[r];if(itemClass=e.$.class.toLocaleLowerCase(),itemClass==s)return e;if(e.Item)return findFirstItemByClassName(e.Item,s)}}function _convertPropertyToType(t,s,e,r){var i,a=t._;switch(t.$.name,s.toLowerCase()){case"string":case"ref":return a;case"int":case"int64":case"double":case"float":case"number":return new Number(a);case"bool":return new Boolean(a);case"coordinateframe":return new RoTypes.CFrame(Number(t.X),Number(t.Y),Number(t.Z),Number(t.R00),Number(t.R01),Number(t.R02),Number(t.R10),Number(t.R11),Number(t.R12),Number(t.R20),Number(t.R21),Number(t.R22));case"color3uint8":return new RoTypes.Color3uint8(Number(a));default:let e;e:try{e=new RoTypes[s]}catch(e){break e}for(const o in e)t[o]&&(i=t[o],e[o]=JSON.parse(i))}}export{BasePart,BaseVector,CFrame,Color3,Color3uint8,FormFactorPart,GuiService,InputType,Instance,Material,Model,PVInstance,Parser,Part,PartType,RoClasses,RoEnums,RoModules$1 as RoModules,RoTypes,SurfaceType,Terrain,Vector3,Workspace,_convertPropertyToType,findFirstItemByClassName,isItem,isXMLTag};

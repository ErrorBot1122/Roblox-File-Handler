import*as xml2js from"xml2js";import*as fs from"fs";class Instance{constructor(){this.Archivable=!0,this.ClassName="Instance",this.Name="",this.Parent=null,this.RobloxLocked=!1,this.Children=[],this._isDistroyed=!1,this.referentId=""}set _isDistroyed(t){!0===t&&this.Distroy()}ClearAllChildren(){null==Children[0]||this._isDistroyed||this.Children.forEach(t=>{Distroy()})}Clone(){if(!this._isDistroyed||this.Archivable){let e=Object.assign({},this);return e.Children=[],this.Children.forEach(t=>{this.Archivable&&e.Children.push(t)}),e}}Distroy(){if(!this._isDistroyed){if(this.Parent){const t=this.Parent.Children.indexOf(this);t=t.splice(x,1),this.Parent=null}this.Archivable=!1,this._isDistroyed=!0,this.ClearAllChildren(),Children=[]}}GetChildren=()=>{this._isDistroyed||this.Children||this.Children};GetDescendants(){if(!this._isDistroyed){let t=this.GetChildren(),e=[...t];return t.forEach(t=>{e.concat(t.GetDescendants())}),e}}IsA=t=>!_isDistroyed&&this instanceof RoModules.Classes[t];IsAncestorOf(t){if(!_isDistroyed){t=t.Parent;return!!t&&(t===this||this.IsAncestorOf(t))}}IsDescendantOf=t=>!_isDistroyed&&t.IsAncestorOf(this)}class PVInstance extends Instance{constructor(){super()}}class BasePart extends PVInstance{constructor(){super(),this.Anchored=!1,this.AssemblyAngularVelocity,this.AssemblyCenterOfMass,this.AssemblyLinearVelocity,this.AssemblyMass,this.AssemblyRootPart,this.BackSurface,this.BottomSurface,this.BrickColor,this.CFrame,this.CanCollide,this.CanQuery,this.CanTouch,this.CastShadow,this.CenterOfMass,this.CollisionGroupId,this.Color,this.CustomPhysicalProperties,this.FrontSurface,this.LeftSurface,this.LocalTransparencyModifier,this.Locked,this.Mass,this.Massless,this.Material,this.Orientation,this.PivotOffset,this.Position,this.ReceiveAge,this.Reflectance,this.ResizeIncrement,this.ResizeableFaces,this.RightSurface,this.RootPriority,this.Rotation,this.Size,this.TopSurface,this.Transparency}}class FormFactorPart extends BasePart{constructor(){super()}}class GuiService extends Instance{constructor(){this.AutoSelectGuiEnabled,this.CoreGuiNavigationEnabled,this.GuiNavigationEnabled,this.MenuIsOpen,this.SelectedObject}}class Model extends PVInstance{constructor(){super(),this.ClassName="Model",this.WorldPivot,this.PrimaryPart,this.LevelOfDetail}}class Part extends FormFactorPart{constructor(){super(),this.ClassName="Part",this.Shape}}class Terrain extends BasePart{constructor(){this.Decoration,this.MaterialColors,this.MaxExtents,this.WaterColor,this.WaterReflectance,this.WaterTransparency,this.WaterWaveSize,this.WaterWaveSpeed}}class Workspace extends Model{constructor(){super(),this.ClassName="Workspace",this.AllowThirdPartySales=!1,this.AnimationWeightedBlendFix,this.ClientAnimatorThrottling,this.CurrentCamera,this.DistributedGameTime,this.FallenPartsDestroyHeight,this.Gravity,this.HumanoidOnlySetCollisionsOnStateChange,this.InterpolationThrottling,this.MeshPartHeadsAndAccessories,this.PhysicsSimulationRate,this.PhysicsSteppingMethod,this.SignalBehavior,this.StreamingEnabled,this.StreamingMinRadius,this.StreamingPauseMode,this.StreamingTargetRadius,this.Terrain,this.TouchesUseCollisionGroups}}function lerp(t,e,s){return(1-s)*t+s*e}function toBytesInt32(t){var e=new ArrayBuffer(4);const s=new DataView(e);return s.setUint32(0,t,!1),e}class BaseVector{constructor(...t){this.values=t}lerp(e,t,...s){let r=[];t instanceof BaseVector?s=t.values:s.push(t);for(let t=0;t<Math.max(this.values.length,s.length);t++){var i=this.values[t]||0,o=s[t]||0;r[t]=lerp(i,o,e)}return new BaseVector(...r)}}class Vector3 extends BaseVector{constructor(t=0,e=0,s=0){super(t,e,s),this.X=this.values[0],this.Y=this.values[1],this.Z=this.values[2]}}class CFrame{constructor(t=0,e=0,s=0,r=0,i=0,o=0,n=0,a=0,c=0,h=0,l=0,u=0){this.x=t,this.y=e,this.z=s,this.R00=r,this.R01=i,this.R02=o,this.R10=n,this.R11=a,this.R12=c,this.R20=h,this.R21=l,this.R22=u,t instanceof Vector3&&this._setXYZFromVector3(t)}_setXYZFromVector3(t,e){this.x=t.x,this.y=t.y,this.z=t.z}get Position(){return new Vector3(this.x,this.y,this.z)}set Position(t){t instanceof Vector3?this._setXYZFromVector3(t):t instanceof Array&&(this.x=t[0],this.x=t[1],this.x=t[2])}}class Color3 extends BaseVector{constructor(t,e,s){super(t,e,s),this.R=t,this.G=e,this.B=s}}class Color3uint8 extends BaseVector{constructor(t,e,s,r=255){if(super(r,t,e,s),"number"==typeof t)if("number"==typeof e)this.values=[r,t,e,s];else{s=toBytesInt32(t);let e=new DataView(s);for(let t=0;t<e.byteLength;t++)this.values[t]=e.getUint8(t)}else t instanceof Color3&&(this.values=[r,...t.values]);this.A=this.values[0],this.alpha=this.values[0],this.R=this.values[1],this.G=this.values[2],this.B=this.values[3],this.Color3=new Color3(this.R,this.G,this.B)}getRGBComponents=()=>[this.R,this.G,this.B]}const InputType={NoInput:0,Constant:12,Sin:13};Object.freeze(InputType);const Material={Plastic:256,Wood:512,Slate:800,Concrete:816,CorrodedMetal:1040,DiamondPlate:1056,Foil:1072,Grass:1280,Ice:1536,Marble:784,Granite:832,Brick:848,Pebble:864,Sand:1296,Fabric:1312,SmoothPlastic:272,Metal:1088,WoodPlanks:528,Cobblestone:880,Air:1792,Water:2048,Rock:896,Glacier:1552,Snow:1328,Sandstone:912,Mud:1344,Basalt:788,Ground:1360,CrackedLava:804,Neon:288,Glass:1568,Asphalt:1376,LeafyGrass:1284,Salt:1392,Limestone:820,Pavement:836,ForceField:1584};Object.freeze(Material);const PartType={Ball:0,Block:1,Cylinder:2};Object.freeze(PartType);const SurfaceType={Smooth:0,Glue:1,Weld:2,Studs:3,Inlet:4,Universal:5,Hinge:6,Motor:7,SteppingMotor:8,SmoothNoOutlines:10};Object.freeze(SurfaceType);class NotFoundError extends Error{constructor(t,e){super(t),this.name=this.constructor.name,this.originalError=e,this.errorParsed=!0,Error.captureStackTrace(this,this.constructor)}}function _errorToCustomError(t){if(null!=t)return t.errorParsed?t:"ENOENT"===t.code?new NotFoundError(`Cound not find file '${t.path}'`,t):void 0}const RoClasses={BasePart:BasePart,FormFactorPart:FormFactorPart,GuiService:GuiService,Instance:Instance,Model:Model,Part:Part,PVInstance:PVInstance,Terrain:Terrain,Workspace:Workspace},RoTypes={BaseVector:BaseVector,CFrame:CFrame,Color3:Color3,Color3uint8:Color3uint8,Vector3:Vector3},RoEnums={InputType:InputType,Material:Material,PartType:PartType,SurfaceType:SurfaceType},RoModules$1={...RoClasses,...RoTypes,...RoEnums},xmlParser=new xml2js.Parser,_announced=[];class Parser{constructor(){this.REFIDTOINSTANCE={}}toValidInstance(t){if(t){if("string"==typeof t)return this.REFIDTOINSTANCE[t];if(t instanceof RoClasses.Instance)return t;if(isItem(t))return this.itemToInstance(t)}return null}itemToInstance(e,t,s){var r={REFIDTOINSTANCE:this.REFIDTOINSTANCE,returnErrors:!1};s={...r,...s};try{if(e.isParsed)return e}catch(t){if(s.returnErrors)throw _errorToCustomError(t);return e}const i=e.Item;var o=e.Properties[0],n=e.$.referent,r=e.$.class;t=this.itemToInstance(t);let a=[],c=null;try{c=new RoClasses[r]}catch(t){return-1==_announced.indexOf(r)&&(console.warn(`Instance Class '${r}' is currentlly unsported\n`),_announced.push(r)),e.isParsed=!1,e}c.isParsed=!0,c.Parent=t,null!=n&&(c.referentId=n,s.REFIDTOINSTANCE[n]=c),i&&i.forEach((t,e)=>a[e]=this.itemToInstance(t,c)),c.Children=a;for(const h in o){const l=o[h];l.forEach(t=>{try{c[t.$.name]=_convertPropertyToType(t,h,s)}catch(t){-1==_announced.indexOf(h)&&(console.warn(`Datatype '${h}' is currentlly unsported\n`),_announced.push(h))}})}return c}fileToObject(t){let e,s;try{e=fs.readFileSync(t)}catch(t){throw _errorToCustomError(t)}return xmlParser.parseString(e,(t,e)=>{if(t)throw t;s=e}),s}xmlToObject(t){let s;return xmlParser.parseString(t,(t,e)=>{if(t)throw _errorToCustomError(t);s=e}),s}objToInstance(t){if(Array.isArray(t)){let e=[];return t.forEach(t=>e.push(objectToInsts(t))),e}return t.Item?itemToInstance(t.Item):isItem(t)?itemToInstance(t):void 0}parseFile(t){t=this.fileToObject(t);if(t.roblox){t=t.roblox;let e=[];const s=t.Item;return s.forEach(t=>e.push(this.itemToInstance(t))),e}}}function isXMLTag(t){if("object"==typeof t){for(const e in t)return!0;return!1}{let s;if(xmlParser.parseString(t,(t,e)=>{if(t)throw t;s=isXMLTag(e)}),s)return s}}const isItem=t=>isXMLTag(t)&&t.$.referent||!t.isParsed;function findFirstItemByClassName(e,s,t){for(var r in s=s.toLocaleLowerCase(),e){let t=e[r];if(itemClass=t.$.class.toLocaleLowerCase(),itemClass==s)return t;if(t.Item)return findFirstItemByClassName(t.Item,s)}return null}function _convertPropertyToType(e,s,t,r){var i,o=e._;switch(e.$.name,s.toLowerCase()){case"string":return o;case"coordinateframe":return new RoTypes.CFrame(Number(e.X),Number(e.Y),Number(e.Z),Number(e.R00),Number(e.R01),Number(e.R02),Number(e.R10),Number(e.R11),Number(e.R12),Number(e.R20),Number(e.R21),Number(e.R22));case"ref":return r[o];case"color3uint8":return new RoTypes.Color3uint8(Number(o));default:let t;try{t=new RoTypes[s]}catch(t){return-1==_announced.indexOf(s)&&(console.warn(`Datatype '${s}' is currentlly unsported\n`),_announced.push(s)),o}for(const n in t)e[n]&&(i=e[n],t[n]=JSON.parse(i));return t}}export{BasePart,BaseVector,CFrame,Color3,Color3uint8,FormFactorPart,GuiService,InputType,Instance,Material,Model,PVInstance,Parser,Part,PartType,RoClasses,RoEnums,RoModules$1 as RoModules,RoTypes,SurfaceType,Terrain,Vector3,Workspace,_convertPropertyToType,findFirstItemByClassName,isItem,isXMLTag};

import*as xml2js from"xml2js";import*as fs from"fs";class Instance{constructor(){this.Archivable=!0,this.ClassName="Instance",this.Name="",this.Parent=null,this.RobloxLocked=!1,this.Children=[],this._isDistroyed=!1,this.referentId=""}set _isDistroyed(e){!0===e&&this.Distroy()}ClearAllChildren(){null==Children[0]||this._isDistroyed||this.Children.forEach(e=>{Distroy()})}Clone(){if(!this._isDistroyed||this.Archivable){let t=Object.assign({},this);return t.Children=[],this.Children.forEach(e=>{this.Archivable&&t.Children.push(e)}),t}}Distroy(){if(!this._isDistroyed){if(this.Parent){const e=this.Parent.Children.indexOf(this);e=e.splice(x,1),this.Parent=null}this.Archivable=!1,this._isDistroyed=!0,this.ClearAllChildren(),Children=[]}}GetChildren=()=>{this._isDistroyed||this.Children||this.Children};GetDescendants(){if(!this._isDistroyed){let e=this.GetChildren(),t=[...e];return e.forEach(e=>{t.concat(e.GetDescendants())}),t}}IsA=e=>!_isDistroyed&&this instanceof RoModules.Classes[e];IsAncestorOf(e){if(!_isDistroyed){e=e.Parent;return!!e&&(e===this||this.IsAncestorOf(e))}}IsDescendantOf=e=>!_isDistroyed&&e.IsAncestorOf(this)}class PVInstance extends Instance{constructor(){super()}}class BasePart extends PVInstance{constructor(){super(),this.Anchored=!1,this.AssemblyAngularVelocity,this.AssemblyCenterOfMass,this.AssemblyLinearVelocity,this.AssemblyMass,this.AssemblyRootPart,this.BackSurface,this.BottomSurface,this.BrickColor,this.CFrame,this.CanCollide,this.CanQuery,this.CanTouch,this.CastShadow,this.CenterOfMass,this.CollisionGroupId,this.Color,this.CustomPhysicalProperties,this.FrontSurface,this.LeftSurface,this.LocalTransparencyModifier,this.Locked,this.Mass,this.Massless,this.Material,this.Orientation,this.PivotOffset,this.Position,this.ReceiveAge,this.Reflectance,this.ResizeIncrement,this.ResizeableFaces,this.RightSurface,this.RootPriority,this.Rotation,this.Size,this.TopSurface,this.Transparency}}class FormFactorPart extends BasePart{constructor(){super()}}class GuiService extends Instance{constructor(){this.AutoSelectGuiEnabled,this.CoreGuiNavigationEnabled,this.GuiNavigationEnabled,this.MenuIsOpen,this.SelectedObject}}class Model extends PVInstance{constructor(){super(),this.ClassName="Model",this.WorldPivot,this.PrimaryPart,this.LevelOfDetail}}class Part extends FormFactorPart{constructor(){super(),this.ClassName="Part",this.Shape}}class Terrain extends BasePart{constructor(){this.Decoration,this.MaterialColors,this.MaxExtents,this.WaterColor,this.WaterReflectance,this.WaterTransparency,this.WaterWaveSize,this.WaterWaveSpeed}}class Workspace extends Model{constructor(){super(),this.ClassName="Workspace",this.AllowThirdPartySales=!1,this.AnimationWeightedBlendFix,this.ClientAnimatorThrottling,this.CurrentCamera,this.DistributedGameTime,this.FallenPartsDestroyHeight,this.Gravity,this.HumanoidOnlySetCollisionsOnStateChange,this.InterpolationThrottling,this.MeshPartHeadsAndAccessories,this.PhysicsSimulationRate,this.PhysicsSteppingMethod,this.SignalBehavior,this.StreamingEnabled,this.StreamingMinRadius,this.StreamingPauseMode,this.StreamingTargetRadius,this.Terrain,this.TouchesUseCollisionGroups}}function lerp(e,t,s){return(1-s)*e+s*t}function toBytesInt32(e){var t=new ArrayBuffer(4);const s=new DataView(t);return s.setUint32(0,e,!1),t}class BaseVector{constructor(...e){this.values=e}lerp(t,e,...s){let r=[];e instanceof BaseVector?s=e.values:s.push(e);for(let e=0;e<Math.max(this.values.length,s.length);e++){var i=this.values[e]||0,o=s[e]||0;r[e]=lerp(i,o,t)}return new BaseVector(...r)}}class Vector3 extends BaseVector{constructor(e=0,t=0,s=0){super(e,t,s),this.X=this.values[0],this.Y=this.values[1],this.Z=this.values[2]}}class CFrame{constructor(e=0,t=0,s=0,r=0,i=0,o=0,n=0,a=0,c=0,l=0,h=0,u=0){this.x=e,this.y=t,this.z=s,this.R00=r,this.R01=i,this.R02=o,this.R10=n,this.R11=a,this.R12=c,this.R20=l,this.R21=h,this.R22=u,e instanceof Vector3&&this._setXYZFromVector3(e)}_setXYZFromVector3(e,t){this.x=e.x,this.y=e.y,this.z=e.z}get Position(){return new Vector3(this.x,this.y,this.z)}set Position(e){e instanceof Vector3?this._setXYZFromVector3(e):e instanceof Array&&(this.x=e[0],this.x=e[1],this.x=e[2])}}class Color3 extends BaseVector{constructor(e,t,s){super(e,t,s),this.R=e,this.G=t,this.B=s}}class Color3uint8 extends BaseVector{constructor(e,t,s,r=255){if(super(r,e,t,s),"number"==typeof e)if("number"==typeof t)this.values=[r,e,t,s];else{s=toBytesInt32(e);let t=new DataView(s);for(let e=0;e<t.byteLength;e++)this.values[e]=t.getUint8(e)}else e instanceof Color3&&(this.values=[r,...e.values]);this.A=this.values[0],this.alpha=this.values[0],this.R=this.values[1],this.G=this.values[2],this.B=this.values[3],this.Color3=new Color3(this.R,this.G,this.B)}getRGBComponents=()=>[this.R,this.G,this.B]}const InputType={NoInput:0,Constant:12,Sin:13};Object.freeze(InputType);const Material={Plastic:256,Wood:512,Slate:800,Concrete:816,CorrodedMetal:1040,DiamondPlate:1056,Foil:1072,Grass:1280,Ice:1536,Marble:784,Granite:832,Brick:848,Pebble:864,Sand:1296,Fabric:1312,SmoothPlastic:272,Metal:1088,WoodPlanks:528,Cobblestone:880,Air:1792,Water:2048,Rock:896,Glacier:1552,Snow:1328,Sandstone:912,Mud:1344,Basalt:788,Ground:1360,CrackedLava:804,Neon:288,Glass:1568,Asphalt:1376,LeafyGrass:1284,Salt:1392,Limestone:820,Pavement:836,ForceField:1584};Object.freeze(Material);const PartType={Ball:0,Block:1,Cylinder:2};Object.freeze(PartType);const SurfaceType={Smooth:0,Glue:1,Weld:2,Studs:3,Inlet:4,Universal:5,Hinge:6,Motor:7,SteppingMotor:8,SmoothNoOutlines:10};Object.freeze(SurfaceType);class NotFoundError extends Error{constructor(e,t){super(e),this.name=this.constructor.name,this.originalError=t,this.errorParsed=!0,Error.captureStackTrace(this,this.constructor)}}function _errorToCustomError(e){if(null!=e)return e.errorParsed?e:"ENOENT"===e.code?new NotFoundError(`Cound not find file '${e.path}'`,e):void 0}const RoClasses={BasePart:BasePart,FormFactorPart:FormFactorPart,GuiService:GuiService,Instance:Instance,Model:Model,Part:Part,PVInstance:PVInstance,Terrain:Terrain,Workspace:Workspace},RoTypes={BaseVector:BaseVector,CFrame:CFrame,Color3:Color3,Color3uint8:Color3uint8,Vector3:Vector3},RoEnums={InputType:InputType,Material:Material,PartType:PartType,SurfaceType:SurfaceType},RoModules$1={...RoClasses,...RoTypes,...RoEnums},xmlParser=new xml2js.Parser;let REFIDTOINSTANCE={};function isXMLTag(e){if("object"==typeof e){for(const t in e)return!0;return!1}xmlParser.parseString(e,(e,t)=>isXMLTag(t))}const isItem=e=>isXMLTag(e)&&e.$.referent||!e.isParsed;function convertValidInstance(e){if(e){if("string"==typeof e)return REFIDTOINSTANCE[e];if(e instanceof RoClasses.Instance)return e;if(isItem(e))return convertItemToInstance(e)}return null}function findFirstItemByClassName(t,s,e){for(var r in s=s.toLocaleLowerCase(),t){let e=t[r];if(itemClass=e.$.class.toLocaleLowerCase(),itemClass==s)return e;if(e.Item)return findFirstItemByClassName(e.Item,s)}return null}function _convertPropertyToType(t,s,r=REFIDTOINSTANCE){var i,o=t._;switch(t.$.name,s.toLowerCase()){case"string":return o;case"coordinateframe":return new RoTypes.CFrame(Number(t.X),Number(t.Y),Number(t.Z),Number(t.R00),Number(t.R01),Number(t.R02),Number(t.R10),Number(t.R11),Number(t.R12),Number(t.R20),Number(t.R21),Number(t.R22));case"ref":return r[o];case"color3uint8":return new RoTypes.Color3uint8(Number(o));default:let e;try{e=new RoTypes[s]}catch(e){return e}for(const n in e)t[n]&&(i=t[n],e[n]=JSON.parse(i));return e}}function convertItemToInstance(t,e,s){if(t.isParsed)return t;s={REFIDTOINSTANCE:{},...s};const r=t.Item;var i=t.Properties[0],o=t.$.referent,n=t.$.class;e=convertValidInstance(e);let a=[],c=null;try{c=new RoClasses[n]}catch(e){return t.isParsed=!1,t}c.isParsed=!0,c.Parent=e,null!=o&&(c.referentId=o,s.REFIDTOINSTANCE[o]=c),r&&r.forEach((e,t)=>{a[t]=convertItemToInstance(e,c)}),c.Children=a;for(const l in i){const h=i[l];h.forEach(e=>_convertPropertyToType(e,l))}return c}function fileToObject(s,r){fs.readFile(s,(e,t)=>{e?r(_errorToCustomError(e),null,s):xmlParser.parseString(t,(e,t)=>{r(_errorToCustomError(e),t,s)})})}function xmlToObject(e,s){xmlParser.parseString(e,(e,t)=>{s(e,t,path)})}function objToInst(e){if(Array.isArray(e)){let t=[];return e.forEach(e=>{t.push(objectToInsts(e))}),t}return e.Item?convertItemToInstance(e.Item):isItem(e)?convertItemToInstance(e):void 0}function parseFile(e,i){fileToObject(e,(e,s)=>{if(e)i(_errorToCustomError(e));else if(s.roblox){s=s.roblox;let t=[];const r=s.Item;r.forEach(e=>{t.push(convertItemToInstance(e))}),i(e,t)}})}export{BasePart,BaseVector,CFrame,Color3,Color3uint8,FormFactorPart,GuiService,InputType,Instance,Material,Model,PVInstance,Part,PartType,RoClasses,RoEnums,RoModules$1 as RoModules,RoTypes,SurfaceType,Terrain,Vector3,Workspace,_convertPropertyToType,convertItemToInstance,convertValidInstance,fileToObject,findFirstItemByClassName,isItem,isXMLTag,objToInst,parseFile,xmlToObject};
